version: "3.1"

rules:
  - rule: 初级回退
    steps:
      - intent: nlu_fallback
      - action: utter_fallback
      - action: action_listen  # 等待用户重新输入

  - rule: 转人工客服
    steps:
      - intent: secondary_fallback  # 用户连续多次未表达清楚
      - action: utter_escalate
      
  # 激活表单
  - rule: Activate form
    steps:
      - intent: ask_disability_service
      - action: disability_service_form
      - active_loop: disability_service_form

  # 表单提交
  - rule: Submit form
    condition:
      - active_loop: disability_service_form
    steps:
      - action: disability_service_form
      - active_loop: null
      - slot_was_set:
        - requested_slot: null
      - action: action_query_materials
  # 激活表单
  - rule: Activate detail form
    steps:
      - intent: ask_service_details
      - action: service_details_form
      - active_loop: service_details_form

  # 表单提交
  - rule: Submit detail  form
    condition:
      - active_loop: service_details_form
    steps:
      - action: service_details_form
      - active_loop: null
      - slot_was_set:
        - requested_slot: null
      - action: action_query_service_details

